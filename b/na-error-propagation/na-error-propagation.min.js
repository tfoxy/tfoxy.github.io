/*!
 * na-error-propagation
 * @see https://github.com/tfoxy/na-error-propagation
 * @version 0.1.1
 * @author Tom√°s Fox <tomas.c.fox@gmail.com>
 * @license MIT
 */
!function(t,r){"use strict";"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?module.exports=r():t.ErrorPropagation=r()}(this,function(){"use strict";function t(t){this.name="InputError",this.message=t}function r(r){switch(r=r||{},r.correlation){case void 0:case"correlated":this._calculateError=u;break;case"uncorrelated":this._calculateError=c;break;case"both":this._calculateError=f;break;default:throw new t("Wrong value for correlation: "+r.correlation+". It must be one of correlated, uncorrelated and both")}}function e(){throw new Error("ErrorPropagation.nerdamer must be set")}function o(t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype.calculate=n}function n(r,e){if(this.emit("input",r,e),"string"!=typeof r)throw new t("expression must be a string. Got "+typeof r);e=e||{};var o=s(e),n=a(r,o),i=this._calculateError(r,e,o,this),u={value:n,error:i};return this.emit("result",u),u}function a(t,e,o){var n=r.nerdamer(t);return r.nerdamer.clear("last"),o&&(o.e=n),n.evaluate(e).valueOf()}function i(t,r,e,o){var n=[];for(var i in r){var u=r[i];if(u.error){var c={},f="diff("+t+","+i+")",s=a(f,e,c),l=s*u.error;o.emit("differential",{value:s,variableName:i,variable:u,valueWithError:l,expression:c.e}),n.push(l)}}return n}function u(t,r,e,o){var n=0,a=i(t,r,e,o);return a.forEach(function(t){n+=t}),n}function c(t,r,e,o){var n=0,a=i(t,r,e,o);return a.forEach(function(t){n+=Math.pow(t,2)}),Math.sqrt(n)}function f(t,r,e,o){var n=0,a=0,u=i(t,r,e,o);return u.forEach(function(t){n+=t,a+=Math.pow(t,2)}),{correlated:n,uncorrelated:Math.sqrt(a)}}function s(t){var r={};for(var e in t){var o=t[e];l(o,e),r[e]=o.value}return r}function l(r,e){if("object"!=typeof r)throw new t("Variable "+e+" is not an object. Got "+typeof r);if(null===r)throw new t("Variable "+e+" must not be null");if(!("value"in r))throw new t("No value for variable "+e)}function p(){var t={prototype:{on:function(){throw new Error("An EventEmitter library needs to be set using HermiteInterpolation.setEventEmitter(EventEmitter) method. The /on/ function cannot be used otherwise")},emit:function(){}}};if("object"==typeof module&&module.exports)try{t=require("events").EventEmitter}catch(r){}return t}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,r.InputError=t,r.nerdamer=e,r.setEventEmitter=o,r.setEventEmitter(p()),r});